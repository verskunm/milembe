((e,t)=>{for(var r in t)e[r]=t[r]})(window,(e=>{var t={};function r(a){if(t[a])return t[a].exports;var s=t[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=(e,t,a)=>{r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=(e,t)=>{if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(a,s,(t=>e[t]).bind(null,s));return a},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,"a",t),t},r.o=(e,t)=>({}.hasOwnProperty.call(e,t)),r.p="https://assets.allegrostatic.com/opbox-selection-form-v2/",r(r.s=0)})({0(e,t,r){e.exports=r("O14P")},O14P(e,t,r){function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.r(t);var s=r("q8gk"),o=r.n(s);class i{constructor({baseNode:e,targetWindow:t=window}){a(this,"handleFieldPropertyChange",e=>{const{target:t}=e;this.sendChangePropertyEvent(t,t.getAttribute("data-analytics-label-suffix"),t.value),t===this.categoriesSelect&&this.changeCategory(e),t.closest('.subcategories-wrapper [data-role="select-wrapper"]')&&this.updateAction()}),a(this,"handleCheckboxPropertyChange",({target:e})=>{this.sendChangePropertyEvent(e,e.getAttribute("data-analytics-label-suffix"),e.checked)}),a(this,"getLabelAsCamelcase",(e="")=>`change${o()(e,{pascalCase:!0})}`),a(this,"sendChangePropertyEvent",(e,t,r)=>{this.targetWindow.opbox.analytics.sendBoxInteractionEvent({contextNode:e,label:this.getLabelAsCamelcase(t),value:r})}),a(this,"changeCategory",e=>{const{target:{options:t,value:r}}=e,{selectedIndex:a}=t,s=t[a];if(this.categoryPath=r,this.updateAction(),this.subcategoriesEnabled){const e=s.getAttribute("data-category-id");this.getSubcategories(e)}}),a(this,"handleFormSubmit",({target:e})=>{const t=i.getQueryParamerersFor(e),r=`${e.getAttribute("action")}?${t}`;this.targetWindow.opbox.analytics.sendClickEvent({contextNode:e,label:"submitSelectionForm",destinationUrl:r})}),this.form=e.querySelector("form"),this.formSelects=Array.from(e.querySelectorAll('[data-role="form-select"]')),this.formInputs=Array.from(e.querySelectorAll('[data-role="form-input"]')),this.formCheckboxes=Array.from(e.querySelectorAll('[data-role="form-checkbox"]')),this.categoriesSelect=e.querySelector(".categories-wrapper select"),this.subcategoriesSelect=e.querySelector(".subcategories-wrapper select"),this.subcategoriesSelectWrapper=e.querySelector('.subcategories-wrapper [data-role="select-wrapper"]'),this.targetWindow=t,this.categoryPath="",this.subcategoriesEnabled=!1,this.setInitialValues()}getCurrentLocationSearch(){return this.targetWindow.location.search}getQueryParam(){const e={};return new URLSearchParams(this.getCurrentLocationSearch()).forEach((t,r)=>{e[r]=t}),e}setInitialValues(){const e=this.getQueryParam();this.formSelects.forEach(t=>{if(!e[t.name])return;const r=[...t.options].find(({value:r})=>r===e[t.name]);r&&(r.setAttribute("selected","selected"),t.value=e[t.name])}),this.formInputs.forEach(t=>{e[t.name]&&t.setAttribute("value",e[t.name])}),this.formCheckboxes.forEach(t=>{e[t.name]&&t.setAttribute("checked","checked")})}static getQueryParamerersFor(e){return[...e.elements].filter(e=>e.name&&!("checkbox"===e.type&&!e.checked)).reduce((e,t)=>{const r=new URLSearchParams(e);return r.set(t.name,t.value),r.toString()},"")}getSubcategories(e){""!==e?window.opbox.edge.get(`/categories?parent.id=${e}`,{headers:{Accept:"application/vnd.allegro.internal.v2+json"},withCredentials:!1}).then(e=>this.createSubcategoriesOptions(e.data.categories)):this.createSubcategoriesOptions([])}createSubcategoriesOptions(e=[]){const t=`\n      <option selected value="">\n        ${this.subcategoriesSelect.getAttribute("data-subcategories-default-option")}\n      </option>`;if(0===e.length)return this.subcategoriesSelectWrapper.classList.add("_z5vfs"),this.subcategoriesSelect.innerHTML=t,void this.updateAction();this.subcategoriesSelectWrapper&&this.subcategoriesSelectWrapper.classList.remove("_z5vfs");const r=e.map(e=>`\n      <option value="${e.id}">${e.name}</option>\n    `).join("");this.subcategoriesSelect.innerHTML=t+r,this.updateAction()}updateAction(){if(!this.subcategoriesEnabled)return this.form.setAttribute("action",this.categoryPath),void this.setSubcategoriesSelectName("");const e=this.subcategoriesSelect;""===e.value?(this.form.setAttribute("action",this.categoryPath),this.setSubcategoriesSelectName("")):(this.form.setAttribute("action",`/kategoria/kategoria-${e.value}`),this.setSubcategoriesSelectName("subcategories"))}setSubcategoriesSelectName(e){this.subcategoriesSelect&&this.subcategoriesSelect.setAttribute("name",e)}onMount(){this.categoriesSelect&&(this.subcategoriesEnabled="true"===this.form.getAttribute("data-subcategories-enabled"),this.setSubcategoriesSelectName(""),this.formSelects.forEach(e=>e.addEventListener("change",this.handleFieldPropertyChange)),this.formInputs.forEach(e=>e.addEventListener("change",this.handleFieldPropertyChange)),this.formCheckboxes.forEach(e=>e.addEventListener("change",this.handleCheckboxPropertyChange)),this.form.addEventListener("submit",this.handleFormSubmit))}onUnmount(){this.categoriesSelect&&(this.formSelects.forEach(e=>e.removeEventListener("change",this.handleFieldPropertyChange)),this.formInputs.forEach(e=>e.removeEventListener("change",this.handleFieldPropertyChange)),this.formCheckboxes.forEach(e=>e.removeEventListener("change",this.handleCheckboxPropertyChange)),this.form.removeEventListener("submit",this.handleFormSubmit))}}window.opbox.component.register({prototypeName:"allegro.selection.form.v2"},i)},q8gk(e,t,r){const a=(e,t)=>{if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("Expected the input to be `string | string[]`");return t=Object.assign({pascalCase:!1},t),0===(e=Array.isArray(e)?e.map(e=>e.trim()).filter(e=>e.length).join("-"):e.trim()).length?"":1===e.length?t.pascalCase?e.toUpperCase():e.toLowerCase():(e!==e.toLowerCase()&&(e=(e=>{let t=!1,r=!1,a=!1;for(let s=0;s<e.length;s++){const o=e[s];t&&/[a-zA-Z]/.test(o)&&o.toUpperCase()===o?(e=e.slice(0,s)+"-"+e.slice(s),t=!1,a=r,r=!0,s++):r&&a&&/[a-zA-Z]/.test(o)&&o.toLowerCase()===o?(e=e.slice(0,s-1)+"-"+e.slice(s-1),a=r,r=!1,t=!0):(t=o.toLowerCase()===o&&o.toUpperCase()!==o,a=r,r=o.toUpperCase()===o&&o.toLowerCase()!==o)}return e})(e)),r=e=e.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,(e,t)=>t.toUpperCase()).replace(/\d+(\w|$)/g,e=>e.toUpperCase()),t.pascalCase?r.charAt(0).toUpperCase()+r.slice(1):r);var r};e.exports=a,e.exports.default=a}}));
//# sourceMappingURL=index.es6-pl-PL_ae9509a5.js.map