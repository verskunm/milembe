!function(e,t){for(var n in t)e[n]=t[n]}(window,function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://assets.allegrostatic.com/opbox-user-inbox/",n(n.s=0)}({0:function(e,t,n){e.exports=n("O14P")},O14P:function(e,t,n){"use strict";n.r(t);var r={};function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(r),n.d(r,"inbox",(function(){return c})),n.d(r,"inbox__login_button",(function(){return l})),n.d(r,"messages",(function(){return f})),n.d(r,"message",(function(){return _})),n.d(r,"message__link",(function(){return d})),n.d(r,"message__text",(function(){return g})),n.d(r,"message__displayed",(function(){return p})),n.d(r,"message__new",(function(){return m})),n.d(r,"message__clicked",(function(){return v})),n.d(r,"message__icon",(function(){return h})),n.d(r,"message__time",(function(){return b})),n.d(r,"message__menu_dropdown",(function(){return y})),n.d(r,"message__menu_dropdown_toggle",(function(){return w})),n.d(r,"message__menu_dropdown_toggle_active",(function(){return j})),n.d(r,"message__menu_dropdown_content_container",(function(){return k})),n.d(r,"message__menu_dropdown_content",(function(){return x})),n.d(r,"message__menu_dropdown_open",(function(){return O})),n.d(r,"message__menu_actions",(function(){return S})),n.d(r,"message__menu_action",(function(){return L})),n.d(r,"message__menu_action_link",(function(){return D})),n.d(r,"message_group",(function(){return A})),n.d(r,"message_group__header",(function(){return E})),n.d(r,"message_group__toggle",(function(){return M})),n.d(r,"message_group__toggle__arrow",(function(){return z})),n.d(r,"message_group__toggle__open",(function(){return q})),n.d(r,"message_group__content",(function(){return P})),n.d(r,"message_group__content__visible",(function(){return C}));var u,c="_0f0f1_2Bksd",l="_0f0f1_1_k5i",f="_0f0f1_S5v3A",_="_0f0f1_uoiqL",d="_0f0f1_2eDRu",g="_0f0f1_1LHgj",p="_0f0f1_10VqG",m="_0f0f1_v_jdB",v="_0f0f1_3q2vd",h="_0f0f1_3Y46r",b="_0f0f1_23LJb",y="_0f0f1_1D6Ts",w="_0f0f1_wPvRI",j="_0f0f1_SWYZl",k="_0f0f1_1fV26",x="_0f0f1_1iS3o",O="_0f0f1_1pOty",S="_0f0f1_36JX9",L="_0f0f1_333Fg",D="_0f0f1_wGOAh",A="_0f0f1_1s2bz",E="_0f0f1_1yf6P",M="_0f0f1_25QVU",z="_0f0f1_3rBh1",q="_0f0f1_1meU6",P="_0f0f1_l4Mcc",C="_0f0f1_2XW8O",N=(u=r,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map((function(e){return u[e]||e})).join(" ")}),T=n("xxrt"),I=(N("inbox",T.h,T.i,T.g,T.j),N(T.k,T.h,"messages")),G=N(T.m,T.v,"message__icon"),R=N(T.g,T.i,T.l,"message__time"),V=N("message__link"),B=N(T.A,T.B),H=N(T.A,T.B,"message__text"),Z=N(T.a,T.f,T.y,T.x),U=T.f,J=N(T.e,T.k,T.w,T.u),W=N(T.a,T.y,T.x),F=N(T.b,T.c,T.u,T.t,"inbox__login_button"),K=N(T.b,T.d),X=(N(T.z,T.s),N("message_group")),Y=N("message_group__header"),Q=N("message_group__content"),$=N("message_group__content__visible"),ee=N("message_group__toggle"),te=N("message_group__toggle__open"),ne=N("message__menu_dropdown_toggle"),re=N("message__menu_dropdown_open"),oe=N("message__menu_dropdown_content_container"),ae=N("message__menu_dropdown"),ie=N("message__menu_dropdown_content"),se=N(T.p,T.r,"message__menu_actions"),ue=N(T.q,"message__menu_action"),ce=N(T.n,T.o,"message__menu_action_link"),le=N("message__menu_dropdown_toggle_active");function fe(e){if(Array.isArray(e))return e}function _e(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function de(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function ge(e,t){return fe(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}return n}}(e,t)||de()}function pe(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var me={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},ve=RegExp(Object.keys(me).join("|"),"g");function he(e){return new be([e+""],[])}var be=function(){function e(t,n){o(this,e),this._parts=t,this._subs=n}return i(e,[{key:"_escapeHtml",value:function(t){return t instanceof e?t:Array.isArray(t)?(null==(o="")&&(o=","),(r=t).length<=0?new be([""],[]):new be([""].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(n=Array(r.length-1).fill(o))||_e(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}(),[""]),r)):(t+"").replace(ve,(function(e){return me[e]}));var n,r,o}},{key:"toString",value:function(){var e=this;return this._parts.reduce((function(t,n,r){var o=e._subs[r-1];return t+e._escapeHtml(o)+n}))}},{key:"inspect",value:function(){return"".concat(this.constructor.name," '").concat(this.toString(),"'")}}]),e}();function ye(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new be(e,n)}function we(){var e=pe(['<div class="','">','<a href="','" class="','" rel="nofollow" data-role="login-button">Zaloguj się</a>','<a href="','" class="','" rel="nofollow" data-analytics-clickable data-role="register-button">Zarejestruj się</a></div>']);return we=function(){return e},e}function je(){var e=pe(['<p class="'," ",'">',"</p>"]);return je=function(){return e},e}function ke(){var e=pe(['<ul class="','" data-role="message-list">',"</ul>"]);return ke=function(){return e},e}function xe(){var e=pe(['<li class="','"><ol class="','">'," ",'</ol><ol class="','">',"</ol></li>"]);return xe=function(){return e},e}function Oe(){var e=pe(['<div class="','" data-role="message-group-toggle">',"</div>"]);return Oe=function(){return e},e}function Se(){var e=pe(['<li class="','" data-role="message">'," ","</li>"]);return Se=function(){return e},e}function Le(){var e=pe(['<a data-role="message-link" href="','" class="','" data-analytics-clickable data-analytics-click-value="','">','<span><span class="','">',"</span>","</span></a>"]);return Le=function(){return e},e}function De(){var e=pe(['<div class="','" data-role="message-actions-dropdown"><button type="button" aria-label="Zarządzaj tą wiadomością" class="'," "," ",'">','</button><div class="','"><div class="','">',"</div></div></div>"]);return De=function(){return e},e}function Ae(){var e=pe(['<ul class="','"><li class="','"><button type="button" class="','" data-role="','" data-id-to-delete="','">',"</button></li></ul>"]);return Ae=function(){return e},e}function Ee(){var e=pe(['<img class="','" src="','" alt="Kategoria" width="100%" height="100%" />']);return Ee=function(){return e},e}function Me(){var e=pe(['<time class="','" datetime="','" aria-label="Wysłane ','">',"</time>"]);return Me=function(){return e},e}function ze(){var e=pe(['<img class="','" src="','" alt="Rozwiń menu" width="100%" height="100%" />']);return ze=function(){return e},e}function qe(){var e=pe(['<img class="','" src="','" alt="Rozwiń grupę" width="100%" height="100%" />']);return qe=function(){return e},e}var Pe,Ce=(Pe=new Date,function(e){var t=function(e){if(e>=2592e3)return"ponad miesiąc";if(e>=86400){var t=Math.floor(e/86400),n=1===t?"dzień":"dni";return"".concat(t," ").concat(n)}return e>=3600?"".concat(Math.floor(e/3600)," godz."):"".concat(Math.max(1,Math.floor(e/60))," min.")}(Math.floor((Pe-e)/1e3));return"".concat(t," temu")}),Ne=N(T.m,T.v,"message_group__toggle__arrow"),Te=ye(qe(),Ne,"https://assets.allegrostatic.com/metrum/icon/arrowhead-408f6067f5.svg"),Ie=ye(ze(),Ne,"https://assets.allegrostatic.com/metrum/icon/three-dots-39687c3861.svg");function Ge(e,t,n){var r=ge(e?["action-delete-group","usuń cały wątek",t]:["action-delete","usuń wiadomość",n],3),o=r[0],a=r[1],i=r[2];return ye(Ae(),se,ue,ce,o,i,a)}function Re(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return ye(De(),ae,ne,T.n,T.o,Ie,oe,ie,Ge(t,n,e))}function Ve(e,t,n,r){var o="".concat("/inbox/redirect/id/").concat(t);return ye(Le(),o,V,n,function(e){return ye(Ee(),G,e)}(r),H,n,he(function(e){var t=new Date(e),n=t.toLocaleDateString(),r=Ce(t);return ye(Me(),R,n,r,r)}(e)))}function Be(e){var t=e.text,n=e.image.svg,r=e.status,o=e.createdAt,a=e.tinkerbellId,i=e.groupId,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],u=N("message","message__".concat(r.toLowerCase()));return ye(Se(),u,Re(a,s,i),Ve(o,a,t,n))}var He=function(e){return Be(e,!1)};function Ze(e){if(1===e.length)return He(e[0]);var t,n=fe(t=e)||_e(t)||de(),r=n[0],o=n.slice(1),a=Be(r,!0),i=o.map(He).join(""),s=ye(Oe(),ee,Te);return ye(xe(),X,Y,he(a),he(s),Q,he(i))}function Ue(e){return"".concat("group_").concat(e)}function Je(e){var t=e.className,n=e.content;return ye(je(),t,B,he(n))}function We(){return Je({className:Z,content:"Nie masz żadnych <br>nowych powiadomień."})}function Fe(e){var t=Je({className:U,content:"Zaloguj się, aby zobaczyć <br>swoje powiadomienia."}),n=Je({className:U,content:"Nie masz jeszcze konta?"}),r="/login/auth?origin_url=".concat(encodeURIComponent(e.location));return ye(we(),W,he(t),r,F,he(n),"/rejestracja",K)}var Ke=".".concat(N("inbox")),Xe=".".concat(ne),Ye=".".concat(Q),Qe=".".concat(ee),$e=".".concat(X),et=function(){function e(t,n,r,a){var i=this;o(this,e),s(this,"onOpen",(function(){i.root.removeEventListener("inViewport",i.onOpen,!1),i.api.getMessages().then(i.onResponse).catch(i.onError)})),s(this,"onResponse",(function(e){var t,n=e.data,r=(t=n.messages).length>0?function(e){var t=function(e){var t=e.reduce((function(e,t){var n=e,r=t.groupId||t.tinkerbellId;return(n[Ue(r)]||(n[Ue(r)]=[])).push(t),n}),{});return Object.values(t)}(e).map(Ze).join("");return ye(ke(),I,he(t))}(t):We();i.setContent(r),i.setupListeners(),i.handleDisplayed(n)})),s(this,"onError",(function(e){var t=401===e.status?Fe(i.window):Je({className:J,content:"Nie mogliśmy wyświetlić Twoich powiadomień."});i.setContent(t)})),s(this,"setContent",(function(e){i.content.innerHTML=e})),s(this,"handleDisplayed",(function(e){var t=e.messages;i.services&&i.services.get("opbox-notification-service").then((function(e){e.reset("inboxes")}));var n=t.filter((function(e){return"CLICKED"!==e.status}));n.length>0&&i.api.updateStatusToDisplayed(n.map((function(e){return e.tinkerbellId})))})),s(this,"setupListeners",(function(){i.root.querySelectorAll(Qe).forEach((function(e){return e.addEventListener("click",i.toggleGroupVisibility)})),i.root.querySelectorAll(Xe).forEach((function(e){return e.addEventListener("click",i.toggleDeleteMessageDropdown)})),i.root.querySelectorAll('[data-role="action-delete"]').forEach((function(e){return e.addEventListener("click",i.singleMessageDeleteListener(e.dataset.idToDelete))})),i.root.querySelectorAll('[data-role="action-delete-group"]').forEach((function(e){return e.addEventListener("click",i.groupMessageDeleteListener(e.dataset.idToDelete))}))})),s(this,"toggleDeleteMessageDropdown",(function(e){e.preventDefault();var t=e.currentTarget.parentElement.parentElement.querySelector('[data-role="message-actions-dropdown"]'),n=t.classList.contains(re);i.root.querySelectorAll('[data-role="message-actions-dropdown"]').forEach(i.hideActionsDropdown),n||(t.classList.add(re),t.querySelector(Xe).classList.add(le))})),s(this,"toggleGroupVisibility",(function(e){e.preventDefault();var t=e.currentTarget,n=t.parentElement;n&&(t.classList.toggle(te),n.parentElement.querySelector(Ye).classList.toggle($))})),this.window=t,this.api=n,this.root=r,this.content=r.querySelector(Ke),this.services=a}return i(e,[{key:"initialize",value:function(){null!==function(e){for(var t=document.cookie.split(/;\s*/),n=t.length-1;n>=0;n-=1){var r=ge(t[n].split("=").map((function(e){return decodeURIComponent(e)})),2),o=r[0],a=r[1];if("qeppo_login2"===o)return a}return null}()?this.root.addEventListener("inViewport",this.onOpen,!1):this.setContent(Fe(this.window))}},{key:"groupMessageDeleteListener",value:function(e){var t=this;return function(n){n.stopPropagation(),t.api.deleteGroup(e),t.deleteMessageListItem(n.target.closest($e)),t.window.opbox.analytics.sendClickEvent({contextNode:t.root,label:"deleteMessageGroup",value:e})}}},{key:"deleteMessageListItem",value:function(e){e.remove(),this.root.querySelectorAll('[data-role="message"]').length||(this.content.innerHTML=We())}},{key:"singleMessageDeleteListener",value:function(e){var t=this;return function(n){n.stopPropagation(),t.api.delete(e),t.deleteSingleMessage(n.target.closest('[data-role="message"]')),t.window.opbox.analytics.sendClickEvent({contextNode:t.root,label:"deleteSingleMessage",value:e})}}},{key:"deleteSingleMessage",value:function(e){var t=e.parentNode,n=t.classList.contains(Q),r=1===t.childElementCount;n&&r&&this.removeGroupToggleControls(t),this.deleteMessageListItem(e)}},{key:"removeGroupToggleControls",value:function(e){var t=e.parentNode.querySelector(Qe);e.remove(),t.remove()}},{key:"hideActionsDropdown",value:function(e){e.classList.remove(re),e.querySelector(Xe).classList.remove(le)}}]),e}();function tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var rt={withCredentials:!0,headers:{Accept:"application/json","Content-type":"application/json"}},ot=nt({},rt,{headers:nt({},rt.headers,{"Content-type":"application/vnd.allegro.public.v2+json"})}),at=function(){function e(t){o(this,e);var n=t.opbox.edge;this.edge=n}return i(e,[{key:"getMessages",value:function(){return this.edge.get("/inbox/messages",rt)}},{key:"updateStatusToDisplayed",value:function(e){var t={tinkerbellIdEvents:e.map((function(e){return{tinkerbellId:e}}))};this.edge.post("/inbox/events/displayed",t,ot)}},{key:"delete",value:function(e){this.edge.delete("".concat("/inbox/messages","/").concat(e),rt)}},{key:"deleteGroup",value:function(e){this.edge.delete("".concat("/inbox/messages/group","/").concat(e),rt)}}]),e}(),it=function(){function e(t){var n=t.baseNode,r=t.services;o(this,e),this.baseNode=n,this.services=r}return i(e,[{key:"onMount",value:function(){var e=new at(window);new et(window,e,this.baseNode,this.services).initialize()}}]),e}();window.opbox.component.register({prototypeName:"allegro.user.inbox"},it)},xxrt:function(e){e.exports=JSON.parse('{"a":"_u5o1q","b":"_13q9y","c":"_8tsq7","d":"_8hkto","e":"_e30lu","f":"_1vryf","g":"_1bo4a","h":"_1xzdi","i":"_sizcr","k":"_1e416","j":"_13prn","m":"_nem5f","n":"_w7z6o","o":"_ypulx","p":"_3a4zn","r":"_12vfa","q":"_1bmp9","t":"_y4398","s":"_bgzci","u":"_xuk25","y":"_w6d6d","x":"_1cdi1","w":"_1a6ks","v":"_1sql3","z":"_6gjm5","A":"_1h7wt","B":"_9hx3e","l":"_6x7yn"}')}}));
//# sourceMappingURL=index_04e5fc14.js.map